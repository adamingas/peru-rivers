
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Code Documentation &#8212; peru-rivers 0.1 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Makefile Commands" href="commands.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="commands.html" title="Makefile Commands"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">peru-rivers 0.1 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="code-documentation">
<h1>Code Documentation<a class="headerlink" href="#code-documentation" title="Permalink to this headline">¶</a></h1>
<p>This page hosts the documentation of the various modules in use by the package.</p>
<div class="section" id="module-src.models.experiment">
<span id="experiment"></span><h2>Experiment<a class="headerlink" href="#module-src.models.experiment" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-experiment"></span><dl class="class">
<dt id="src.models.experiment.Experiment">
<em class="property">class </em><code class="sig-prename descclassname">src.models.experiment.</code><code class="sig-name descname">Experiment</code><span class="sig-paren">(</span><em class="sig-param">meta_data: pandas.core.frame.DataFrame</em>, <em class="sig-param">estimator</em>, <em class="sig-param">grid: dict = None</em>, <em class="sig-param">estimator_name=None</em>, <em class="sig-param">train_test_column='group'</em>, <em class="sig-param">target_column='target'</em>, <em class="sig-param">names=(None</em>, <em class="sig-param">None)</em>, <em class="sig-param">train_test_split_method=StratifiedKFold(n_splits=7</em>, <em class="sig-param">random_state=None</em>, <em class="sig-param">shuffle=False)</em>, <em class="sig-param">css_normalisation=CSSNormaliser(log = False</em>, <em class="sig-param">identity = True)</em>, <em class="sig-param">validation_method_group: tuple = (None</em>, <em class="sig-param">None)</em>, <em class="sig-param">scaler=FunctionTransformer(accept_sparse=False</em>, <em class="sig-param">check_inverse=True</em>, <em class="sig-param">func=None</em>, <em class="sig-param">inv_kw_args=None</em>, <em class="sig-param">inverse_func=None</em>, <em class="sig-param">kw_args=None</em>, <em class="sig-param">pass_y='deprecated'</em>, <em class="sig-param">validate=False)</em>, <em class="sig-param">resampler=FunctionSampler(accept_sparse=True</em>, <em class="sig-param">func=None</em>, <em class="sig-param">kw_args=None)</em>, <em class="sig-param">cv_suffix: str = '_cv'</em>, <em class="sig-param">features=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#src.models.experiment.Experiment" title="Permalink to this definition">¶</a></dt>
<dd><p>This class is used for experiment creation.</p>
<dl class="method">
<dt id="src.models.experiment.Experiment.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">meta_data: pandas.core.frame.DataFrame</em>, <em class="sig-param">estimator</em>, <em class="sig-param">grid: dict = None</em>, <em class="sig-param">estimator_name=None</em>, <em class="sig-param">train_test_column='group'</em>, <em class="sig-param">target_column='target'</em>, <em class="sig-param">names=(None</em>, <em class="sig-param">None)</em>, <em class="sig-param">train_test_split_method=StratifiedKFold(n_splits=7</em>, <em class="sig-param">random_state=None</em>, <em class="sig-param">shuffle=False)</em>, <em class="sig-param">css_normalisation=CSSNormaliser(log = False</em>, <em class="sig-param">identity = True)</em>, <em class="sig-param">validation_method_group: tuple = (None</em>, <em class="sig-param">None)</em>, <em class="sig-param">scaler=FunctionTransformer(accept_sparse=False</em>, <em class="sig-param">check_inverse=True</em>, <em class="sig-param">func=None</em>, <em class="sig-param">inv_kw_args=None</em>, <em class="sig-param">inverse_func=None</em>, <em class="sig-param">kw_args=None</em>, <em class="sig-param">pass_y='deprecated'</em>, <em class="sig-param">validate=False)</em>, <em class="sig-param">resampler=FunctionSampler(accept_sparse=True</em>, <em class="sig-param">func=None</em>, <em class="sig-param">kw_args=None)</em>, <em class="sig-param">cv_suffix: str = '_cv'</em>, <em class="sig-param">features=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#src.models.experiment.Experiment.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Each instance of this class is a classification experiment which stores all the configurations and the results.
This object is used to run the experiment procedure, using all the attributes passed or implied by its creation.
The only parameters necessary for the creation of an experiment are the meta-data Dataframe (properly formated)
and an estimator (from the default ones).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A properly formatted meta-data dataframe has the values of the response (target) variable under the column
<cite>target</cite>, and the values of the variable used to split the dataset into train and test sets (and the
train into validation sets) under the column <cite>group</cite>. For the purposes of the paper, the meta-data dataframe
is the wwfdf csv found in <cite>data/processed</cite>. The target values can be either under the column <cite>Water</cite> or
<cite>River_loc</cite>.</p>
</div>
<p>A minimal example initialising an Experiment object is given below</p>
<p>example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="c1"># project_dir is the path to the project directory</span>
<span class="n">wwfdf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">project_dir</span><span class="o">+</span><span class="s2">&quot;data/processed/wwfdf&quot;</span><span class="p">,</span><span class="n">index_col</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="c1"># creating the object</span>
<span class="n">experiment_object</span> <span class="o">=</span> <span class="n">Experiment</span><span class="p">(</span><span class="n">meta_data</span> <span class="o">=</span> <span class="n">wwfdf</span><span class="p">,</span> <span class="n">estimator</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">,</span>
                               <span class="n">target_column</span> <span class="o">=</span> <span class="s2">&quot;Water&quot;</span><span class="p">,</span><span class="n">train_test_column</span> <span class="o">=</span> <span class="s2">&quot;Area_group&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>meta_data</strong> – The meta-data dataframe that contains the target, train_test_group and validation_group columns.
The default names for the columns are “target” for the target variable, and “group” for the train_test_group
and validation_group</p></li>
<li><p><strong>target_column</strong> – The column in the meta_data dataframe where the values of the target variable are found.
default is <cite>target</cite></p></li>
<li><p><strong>train_test_column</strong> – The column in the meta_data dataframe where the values of the variable used to split
the samples into train.and test sets are found. default is <cite>group</cite></p></li>
<li><p><strong>train_test_split_method</strong> – StratifiedKFold or GroupKFold</p></li>
<li><p><strong>estimator</strong> – estimator object,</p></li>
<li><p><strong>grid</strong> – grid of hyperparameters</p></li>
<li><p><strong>estimator_name</strong> – name of estimator</p></li>
<li><p><strong>css_normalisation</strong> – CSSNormalisation object</p></li>
<li><p><strong>validation_method_group</strong> – A tuple which specifies the method used to split the train set into folds,
and which column of the meta_data is going to be used as the group variable
(StratifiedKFold or GroupKFold,column_name_for_grouping)</p></li>
<li><p><strong>scaler</strong> – sklearn.preprocessing method</p></li>
<li><p><strong>resampler</strong> – imblearn.over_sampler method</p></li>
<li><p><strong>cv_method</strong> – str
Choose from {“_cv”,”_bcv”,”_rcv”}</p></li>
<li><p><strong>names</strong> – (str,str)
Names of feature and meta data set</p></li>
<li><p><strong>features</strong> – pandas DataFrame
The features to be used for running the experiment or for fitting. If not given then when calling then run
method of the object, they have to be passed together with meta_data</p></li>
<li><p><strong>kwargs</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="src.models.experiment.Experiment.default_grid">
<code class="sig-name descname">default_grid</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#src.models.experiment.Experiment.default_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>If a hyperparameter grid is not specified when the experiment is created then this method is used to
find the appropriate grid. If the same experiment is used but with a different (deafult) classifier then use
this method to update the grid.</p>
</dd></dl>

<dl class="method">
<dt id="src.models.experiment.Experiment.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param">x_train: pandas.core.frame.DataFrame</em>, <em class="sig-param">meta_train: pandas.core.frame.DataFrame</em>, <em class="sig-param">validation_group=None</em><span class="sig-paren">)</span><a class="headerlink" href="#src.models.experiment.Experiment.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Trains the model by cross validation using the parameters of the object.
For this method, the cv generator is taken to be the validation_method. train_test_method which was used
in the run() method to split the set into train and test is not used in this case.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_train</strong> – samples with features</p></li>
<li><p><strong>meta_train</strong> – meta data with target and validation columns</p></li>
<li><p><strong>validation_group</strong> – an array with the validation group values.
if none is given then the meta_train is indexed to get the target and validation columns. If an array is given
then the meta_train is taken to be just the target variable that will be used to fit the model</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>best set of hyperparameters from crossvalidation and the feature coefficients</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="src.models.experiment.Experiment.return_dictionary">
<code class="sig-name descname">return_dictionary</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#src.models.experiment.Experiment.return_dictionary" title="Permalink to this definition">¶</a></dt>
<dd><p>returns some parameters of the instance in a dictionary
:return:</p>
</dd></dl>

<dl class="method">
<dt id="src.models.experiment.Experiment.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param">X: pandas.core.frame.DataFrame = None</em>, <em class="sig-param">y: pandas.core.frame.DataFrame = None</em><span class="sig-paren">)</span><a class="headerlink" href="#src.models.experiment.Experiment.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs the experiment on the data set using the attributes used to create the object.
The results are stored as attributes of the object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – The features used to train the classifiers. If None, then the features given in the construction of
the objection will be used</p></li>
<li><p><strong>y</strong> – The meta-data dataframe used to initiate the experiment object. It’s a redundant variable that’s only
left in the package in case the user decides to delete the meta-data attribute before saving the object into
pickle format in order to conserve space.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary with the following keys
“y_pred”: predictions made by classifier
“best_parameters”: best hyper parameters
“coefficients”: coefficients of features if present
“time”: time it takes for the procedure to complete
“false_samples”: which samples where wrongly classified
“confusion”:confusion matrix of</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-src.models.methods">
<span id="methods"></span><h2>Methods<a class="headerlink" href="#module-src.models.methods" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-methods"></span><dl class="class">
<dt id="src.models.methods.CV_models">
<em class="property">class </em><code class="sig-prename descclassname">src.models.methods.</code><code class="sig-name descname">CV_models</code><span class="sig-paren">(</span><em class="sig-param">grid</em>, <em class="sig-param">estimator</em>, <em class="sig-param">parameter_search</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#src.models.methods.CV_models" title="Permalink to this definition">¶</a></dt>
<dd><p>The CrossValidation object that performs hyperparameter search for the supplied estimator and validation folds.
The implemented hyperparameter search methods are</p>
<blockquote>
<div><ul class="simple">
<li><p>grid: Exhaustive search. All combinations of hyperparameters are tried on all validation folds. Time consuming
if the size of the grid is large</p></li>
<li><p>random: hyperparameters combinations are randomly sampled and tried. The number of iterations determines the
speed and accuracy</p></li>
<li><p>bayes: Using bayesian optimisiation to choose the combinations of hyperparameters to try. Performs better thab
random when using large grids.</p></li>
</ul>
</div></blockquote>
<dl class="method">
<dt id="src.models.methods.CV_models.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">grid</em>, <em class="sig-param">estimator</em>, <em class="sig-param">parameter_search</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#src.models.methods.CV_models.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>This object is used by the Experiment object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid</strong> – dict
Grid of parameter space to search for the best set of hyperparameters</p></li>
<li><p><strong>estimator</strong> – sklearn estimator</p></li>
<li><p><strong>parameter_search</strong> – str
The method used to search over parameter space. Options are “grid”, “random” and “bayes”
Default is Grid, but Randomized and bayesian will be developed as well.</p></li>
<li><p><strong>validation_kfold_method</strong> – sklearn.model_selection KFold method
StratifiedKFold or GroupKFold methods</p></li>
<li><p><strong>validation_group</strong> – </p></li>
<li><p><strong>number_of_kfolds</strong> – int
Number of times to split the data</p></li>
<li><p><strong>kwargs</strong> – optional kwargs</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="src.models.methods.CV_models.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param">features</em>, <em class="sig-param">target</em>, <em class="sig-param">ksets=None</em><span class="sig-paren">)</span><a class="headerlink" href="#src.models.methods.CV_models.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the estimator to features and targets, using Cross validation. The Cross validation procedure uses the
validation_group as the groupping/strata.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ksets</strong> – <ul>
<li><p>None, to use the default 3-fold cross validation,</p></li>
<li><p>integer, to specify the number of folds in a (Stratified)KFold,</p></li>
<li><p>CV splitter,</p></li>
<li><p>An iterable yielding (train, test) splits as arrays of indices.</p></li>
</ul>
</p></li>
<li><p><strong>features</strong> – ndarray or pandas dataframe
Features set, or X</p></li>
<li><p><strong>target</strong> – 1darray or pandas series
The class of each sample, or y</p></li>
<li><p><strong>validation_group</strong> – 1darray or pandas series
Group/Strata for GroupKFold/StratifiedKFold</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>best_parameters, model, coefficients</p>
<ul class="simple">
<li><p>list: Set of best hyperparameters</p></li>
<li><p>model: fitted model on features and target</p></li>
<li><p>coefficients: Cofficients or feature importances for each feature. Can be NoneType if the estimator doesnt
support it</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="src.models.methods.CV_models.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param">features</em><span class="sig-paren">)</span><a class="headerlink" href="#src.models.methods.CV_models.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>The trained model is used to predict the class of features</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>features</strong> – array-like
has to have the same number of features as train-features set</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>predictions</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-src.models.default_config">
<span id="default-configuration"></span><h2>Default configuration<a class="headerlink" href="#module-src.models.default_config" title="Permalink to this headline">¶</a></h2>
<p>The default configuration file used to replicate the experiments of the paper.
A dictionary outlining the attributes of a number of experiments is created, and then the product of the choices  is
used to initialise a number of experiments succintly.</p>
<p>A sample dictionary used to run the water as labels experiments in the dissimilarity setting (GroupKFold).</p>
<p>All values to keys have to be in a list.</p>
<p>The product of all choices is used to create experiments. In this case the experiments created are:</p>
<p>table:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Features</span> <span class="n">Meta</span> <span class="n">target</span> <span class="n">train_test</span> <span class="n">FoldMethod</span> <span class="n">splits</span> <span class="n">Estimator</span>    <span class="n">css</span>  <span class="n">scaler</span> <span class="n">resampler</span> <span class="n">validationKFold</span> <span class="n">splits</span> <span class="n">cv_search</span>
<span class="o">---------------------------------------------------------------------------------------------------------------------</span>
<span class="n">riverdf</span>  <span class="n">wwfdf</span> <span class="n">Water</span> <span class="n">Area_group</span> <span class="n">GroupKFold</span> <span class="mi">7</span>      <span class="n">RandomForest</span> <span class="kc">None</span> <span class="kc">None</span>   <span class="kc">None</span>      <span class="n">GroupKfold</span>      <span class="mi">6</span>      <span class="n">grid</span>
<span class="n">riverdf</span>  <span class="n">wwfdf</span> <span class="n">Water</span> <span class="n">Area_group</span> <span class="n">GroupKFold</span> <span class="mi">7</span>      <span class="n">RandomForest</span> <span class="kc">None</span> <span class="kc">None</span>   <span class="n">CSS</span>       <span class="n">GroupKfold</span>      <span class="mi">6</span>      <span class="n">grid</span>
<span class="n">riverdf</span>  <span class="n">wwfdf</span> <span class="n">Water</span> <span class="n">Area_group</span> <span class="n">GroupKFold</span> <span class="mi">7</span>      <span class="n">RandomForest</span> <span class="kc">None</span> <span class="kc">None</span>   <span class="n">CSSLOG</span>    <span class="n">GroupKfold</span>      <span class="mi">6</span>      <span class="n">grid</span>
<span class="n">riverdf</span>  <span class="n">wwfdf</span> <span class="n">Water</span> <span class="n">Area_group</span> <span class="n">GroupKFold</span> <span class="mi">7</span>      <span class="n">MultinomialNBNone</span> <span class="kc">None</span>   <span class="kc">None</span>      <span class="n">GroupKfold</span>      <span class="mi">6</span>      <span class="n">grid</span>
<span class="n">riverdf</span>  <span class="n">wwfdf</span> <span class="n">Water</span> <span class="n">Area_group</span> <span class="n">GroupKFold</span> <span class="mi">7</span>      <span class="n">MultinomialNBNone</span> <span class="kc">None</span>   <span class="n">CSS</span>       <span class="n">GroupKfold</span>      <span class="mi">6</span>      <span class="n">grid</span>
<span class="n">riverdf</span>  <span class="n">wwfdf</span> <span class="n">Water</span> <span class="n">Area_group</span> <span class="n">GroupKFold</span> <span class="mi">7</span>      <span class="n">MultinomialNBNone</span> <span class="kc">None</span>   <span class="n">CSSLOG</span>    <span class="n">GroupKfold</span>      <span class="mi">6</span>      <span class="n">grid</span>
<span class="n">riverdf</span>  <span class="n">wwfdf</span> <span class="n">Water</span> <span class="n">Area_group</span> <span class="n">GroupKFold</span> <span class="mi">7</span>      <span class="n">SVM</span>          <span class="kc">None</span> <span class="kc">None</span>   <span class="kc">None</span>      <span class="n">GroupKfold</span>      <span class="mi">6</span>      <span class="n">grid</span>
<span class="n">riverdf</span>  <span class="n">wwfdf</span> <span class="n">Water</span> <span class="n">Area_group</span> <span class="n">GroupKFold</span> <span class="mi">7</span>      <span class="n">SVM</span>          <span class="kc">None</span> <span class="kc">None</span>   <span class="n">CSS</span>       <span class="n">GroupKfold</span>      <span class="mi">6</span>      <span class="n">grid</span>
<span class="n">riverdf</span>  <span class="n">wwfdf</span> <span class="n">Water</span> <span class="n">Area_group</span> <span class="n">GroupKFold</span> <span class="mi">7</span>      <span class="n">SVM</span>          <span class="kc">None</span> <span class="kc">None</span>   <span class="n">CSSLOG</span>    <span class="n">GroupKfold</span>      <span class="mi">6</span>      <span class="n">grid</span>
<span class="n">fulldf</span>   <span class="n">wwfdf</span> <span class="n">Water</span> <span class="n">Area_group</span> <span class="n">GroupKFold</span> <span class="mi">7</span>      <span class="n">RandomForest</span> <span class="kc">None</span> <span class="kc">None</span>   <span class="kc">None</span>      <span class="n">GroupKfold</span>      <span class="mi">6</span>      <span class="n">grid</span>
<span class="n">fulldf</span>   <span class="n">wwfdf</span> <span class="n">Water</span> <span class="n">Area_group</span> <span class="n">GroupKFold</span> <span class="mi">7</span>      <span class="n">RandomForest</span> <span class="kc">None</span> <span class="kc">None</span>   <span class="n">CSS</span>       <span class="n">GroupKfold</span>      <span class="mi">6</span>      <span class="n">grid</span>
<span class="n">fulldf</span>   <span class="n">wwfdf</span> <span class="n">Water</span> <span class="n">Area_group</span> <span class="n">GroupKFold</span> <span class="mi">7</span>      <span class="n">RandomForest</span> <span class="kc">None</span> <span class="kc">None</span>   <span class="n">CSSLOG</span>    <span class="n">GroupKfold</span>      <span class="mi">6</span>      <span class="n">grid</span>
<span class="n">fulldf</span>   <span class="n">wwfdf</span> <span class="n">Water</span> <span class="n">Area_group</span> <span class="n">GroupKFold</span> <span class="mi">7</span>      <span class="n">MultinomialNBNone</span> <span class="kc">None</span>   <span class="kc">None</span>      <span class="n">GroupKfold</span>      <span class="mi">6</span>      <span class="n">grid</span>
<span class="n">fulldf</span>   <span class="n">wwfdf</span> <span class="n">Water</span> <span class="n">Area_group</span> <span class="n">GroupKFold</span> <span class="mi">7</span>      <span class="n">MultinomialNBNone</span> <span class="kc">None</span>   <span class="n">CSS</span>       <span class="n">GroupKfold</span>      <span class="mi">6</span>      <span class="n">grid</span>
<span class="n">fulldf</span>   <span class="n">wwfdf</span> <span class="n">Water</span> <span class="n">Area_group</span> <span class="n">GroupKFold</span> <span class="mi">7</span>      <span class="n">MultinomialNBNone</span> <span class="kc">None</span>   <span class="n">CSSLOG</span>    <span class="n">GroupKfold</span>      <span class="mi">6</span>      <span class="n">grid</span>
<span class="n">fulldf</span>   <span class="n">wwfdf</span> <span class="n">Water</span> <span class="n">Area_group</span> <span class="n">GroupKFold</span> <span class="mi">7</span>      <span class="n">SVM</span>          <span class="kc">None</span> <span class="kc">None</span>   <span class="kc">None</span>      <span class="n">GroupKfold</span>      <span class="mi">6</span>      <span class="n">grid</span>
<span class="n">fulldf</span>   <span class="n">wwfdf</span> <span class="n">Water</span> <span class="n">Area_group</span> <span class="n">GroupKFold</span> <span class="mi">7</span>      <span class="n">SVM</span>          <span class="kc">None</span> <span class="kc">None</span>   <span class="n">CSS</span>       <span class="n">GroupKfold</span>      <span class="mi">6</span>      <span class="n">grid</span>
<span class="n">fulldf</span>   <span class="n">wwfdf</span> <span class="n">Water</span> <span class="n">Area_group</span> <span class="n">GroupKFold</span> <span class="mi">7</span>      <span class="n">SVM</span>          <span class="kc">None</span> <span class="kc">None</span>   <span class="n">CSSLOG</span>    <span class="n">GroupKfold</span>      <span class="mi">6</span>      <span class="n">grid</span>
</pre></div>
</div>
<p>Specifying all these would be tiresome and unnecesary since they share so many attributes. Thus this system of products 
was devised. In particular the product happens like this:
The “Data” and “train_test_split_method” values are multiplied. For the water dissimilarity dictionary, there are two 
elements for data and one for train_test_split_method, thus there are 2 combinations.
All values of the “models” keys are multiplied; in the first element of the model list there are 6 combinations
(RandomForest and MultinomialNB), and in the second 3 (SVM). 
Thus in total there are 9 model combinations and 2 data. 2X9 = 18 total experiments.</p>
<p>An example dictionary</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span> <span class="c1"># [M] Mandatory, [O] Optional</span>
<span class="s2">&quot;Data&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;features&quot;</span><span class="p">:</span><span class="s2">&quot;riverdf&quot;</span><span class="p">,</span> <span class="s2">&quot;meta&quot;</span><span class="p">:</span><span class="s2">&quot;wwfdf&quot;</span><span class="p">,</span><span class="s2">&quot;target_col&quot;</span><span class="p">:</span> <span class="s2">&quot;Water&quot;</span><span class="p">,</span><span class="s2">&quot;train_test_col&quot;</span><span class="p">:</span><span class="s2">&quot;Area_group&quot;</span><span class="p">},</span>
         <span class="p">{</span><span class="s2">&quot;features&quot;</span><span class="p">:</span><span class="s2">&quot;fulldf&quot;</span><span class="p">,</span> <span class="s2">&quot;meta&quot;</span><span class="p">:</span><span class="s2">&quot;wwfdf&quot;</span><span class="p">,</span><span class="s2">&quot;target_col&quot;</span><span class="p">:</span> <span class="s2">&quot;Water&quot;</span><span class="p">,</span><span class="s2">&quot;train_test_col&quot;</span><span class="p">:</span><span class="s2">&quot;Area_group&quot;</span><span class="p">}],</span>
<span class="c1"># [M] features: The name of the features data set. The program will search the folder data/processed</span>
<span class="c1"># [M] meta: The name of the meta data set. The program will search the folder data/processed</span>
<span class="c1"># [O] target_col: is the column where the labels can be found, default value is  &quot;target&quot;</span>
<span class="c1"># [O] train_test_col: is the column used to split the set to train and</span>
<span class="c1"># test, default &quot;group&quot; if it exists, if not then &quot;target&quot; column</span>
<span class="s2">&quot;train_test_split_method&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;GroupKFold&quot;</span><span class="p">,</span><span class="s2">&quot;n_splits&quot;</span><span class="p">:</span><span class="mi">7</span><span class="p">}],</span>
<span class="c1"># [O] How to generate train-test splits, can either be passed as a string or a dictionary. The dictionary will pass</span>
<span class="c1">#     all keys associated with the method as arguments.</span>
<span class="c1">#     name: The method used to split, most commonly used are StratifiedKFold and GroupKFold. All possible choices</span>
<span class="c1">#     can be found in sklearn.model_selection</span>
<span class="c1">#     https://scikit-learn.org/stable/modules/classes.html#module-sklearn.model_selection</span>
<span class="c1">#     Common arguments:</span>
<span class="c1">#      n_splits: Number of folds/splits to create</span>
<span class="c1">#      random_state: The seed used by random procedures (e.g. StratifiedKFold)</span>
<span class="s2">&quot;models&quot;</span><span class="p">:</span> <span class="c1"># [M] This key ise used to set up the experiments by choosing what classifiers to use. what normalisation</span>
          <span class="c1"># and transformation techniques and how to split the training set so as to perform cross validation</span>
    <span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;estimators&quot;</span><span class="p">:[</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;MultinomialNB&quot;</span><span class="p">},{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;RandomForest&quot;</span><span class="p">}],</span>
        <span class="c1"># estimators: A list of strings/dictionaries specifiying what estimators to use and with what arguments (with</span>
        <span class="c1">#             the dictionary).</span>
        <span class="c1">#     name: The name of the estimator used. The default estimators are {&quot;RandomForest&quot;,&quot;LogisticRegression&quot;</span>
        <span class="c1">#     , &quot;SVM&quot;,&quot;BernoulliNB&quot;,&quot;MultinomialNB&quot;,&quot;ComplementNB&quot;,&quot;KNN&quot; (for K nearest Neighbours)}, and are</span>
        <span class="c1">#     implemented in the sklearn library.</span>
        <span class="c1">#     Optional Arguments</span>
        <span class="c1">#     cv: Cross validation search method to use. How to search over hyperparameters. The choices currently</span>
        <span class="c1">#     implementes are random and grid. default is grid</span>
        <span class="c1">#     n_iter: If random cv is chosen, n_iter controls the number of</span>
        <span class="c1">#     grid: A dictionary of hyperparameters over which the cv method will search to find the best set</span>
        <span class="c1">#     Estimator Arguments: Any other arguments that the estimators use. Search for their sklearn</span>
        <span class="c1">#     implementation to find out what keys can be used.</span>
        <span class="c1">#    Custom estimators can also be constructed and used by the program. To do so the additional method and</span>
        <span class="c1">#    grid key has to be used.</span>
        <span class="c1">#      method: The estimator object that is compatible with sklearn. It must have the attributes fit,</span>
        <span class="c1">#      predict, set_params, get_params.</span>
        <span class="c1">#      grid: A dictionary specifying the space over which the cross validation procedure will search.</span>
        <span class="c1">#      Example grids are given above in the default_grids variable which is a dictionary of grids for</span>
        <span class="c1">#      various classifiers</span>
        <span class="c1">#      Example Dictionary</span>
        <span class="c1">#      {&quot;name&quot;:&quot;Pipeline&quot;,&quot;method&quot;:Pipeline([(&quot;resampler&quot;,RandomOverSampler()),</span>
        <span class="c1">#       (&quot;RFR&quot;,RandomForestClassifier())]),&quot;grid&quot;:space,&quot;n_iter&quot;:2,&quot;cv&quot;:&quot;bayes&quot;}</span>
        <span class="c1">#</span>
        <span class="c1">#</span>
        <span class="s2">&quot;css&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;CSSLOG&quot;</span><span class="p">,</span><span class="s2">&quot;CSS&quot;</span><span class="p">,</span><span class="kc">None</span><span class="p">],</span>
        <span class="c1"># [O] Controls the use of CSS normalisation and log transformation. The program iteratires over all choices</span>
        <span class="c1">#     passed here. The choices are</span>
        <span class="c1">#     None: Nothing is used</span>
        <span class="c1">#     CSS: CSS normalisation is used.</span>
        <span class="c1">#     CSSLOG: CSS normalisation and log transformation is used</span>
        <span class="s2">&quot;scaler&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">],</span>
        <span class="c1"># [O] Controls the use of scalers, implemented in the sklearn.preprocessing package. The preferred scaler</span>
        <span class="c1">#     can be passed as a string or a dictionary. The form of the dictionary is</span>
        <span class="c1">#     {&quot;name&quot;:&quot;any_appropriate_scaler&gt;&quot;, &quot;optional_arguments_for_the_scaler&quot;:values}.</span>
        <span class="c1">#     An example of a Standard scaler is</span>
        <span class="c1">#     {&quot;name&quot;:&quot;StandardScaler&quot;,&quot;with_mean&quot;:False}</span>
        <span class="s2">&quot;resampler&quot;</span><span class="p">:[</span><span class="kc">None</span><span class="p">],</span>
        <span class="c1"># [O] Controls the use of resamplers, implemented in the imblearn.over_sampling package. The preferred</span>
        <span class="c1">#     resampler can be passed as a string or dictionary.&gt; The form of the dictionary is</span>
        <span class="c1">#     {&quot;name&quot;:&quot;&lt;any_appropriate_resampler_in_imblearn&gt;&quot;, &quot;optional_arguments_of_the_resampler&quot;:values}</span>
        <span class="c1">#     Examples of OverSamplers include RandomOverSampling, SMOTE, SMOTE1, SMOTE2, ADASYN</span>
        <span class="s2">&quot;validation&quot;</span><span class="p">:[{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;GroupKFold&quot;</span><span class="p">,</span><span class="s2">&quot;group_col&quot;</span><span class="p">:</span><span class="s2">&quot;Area_group&quot;</span><span class="p">,</span><span class="s2">&quot;n_splits&quot;</span><span class="p">:</span><span class="mi">6</span><span class="p">}]</span>
        <span class="c1"># [O] The validation method and group column to use for cross validation.</span>
        <span class="c1">#     name: The name of the splitting method, any object in sklearn.model_selection package can be used,</span>
        <span class="c1">#     default StratiedKFold</span>
        <span class="c1">#     n_splits: Number of folds to create, default 3</span>
        <span class="c1">#     group_col: The column in the meta_data to use for splitting the folds</span>

    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;estimators&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;SVM&quot;</span><span class="p">,</span><span class="s2">&quot;kernel&quot;</span><span class="p">:</span><span class="s2">&quot;poly&quot;</span><span class="p">,</span><span class="s2">&quot;degree&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">}],</span>
        <span class="s2">&quot;css&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;CSSLOG&quot;</span><span class="p">,</span> <span class="s2">&quot;CSS&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>

        <span class="s2">&quot;scaler&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;StandardScaler&quot;</span><span class="p">,</span><span class="s2">&quot;with_mean&quot;</span><span class="p">:</span><span class="kc">False</span><span class="p">}],</span>
        <span class="s2">&quot;resampler&quot;</span><span class="p">:[</span><span class="kc">None</span><span class="p">],</span>
        <span class="s2">&quot;validation&quot;</span><span class="p">:[{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;GroupKFold&quot;</span><span class="p">,</span><span class="s2">&quot;group_col&quot;</span><span class="p">:</span><span class="s2">&quot;Area_group&quot;</span><span class="p">,</span><span class="s2">&quot;n_splits&quot;</span><span class="p">:</span><span class="mi">6</span><span class="p">}]</span>
    <span class="p">}</span>
<span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="data">
<dt id="src.models.default_config.river_size">
<code class="sig-prename descclassname">src.models.default_config.</code><code class="sig-name descname">river_size</code><em class="property"> = {'Data': [{'features': 'riverdf', 'meta': 'wwfdf', 'target_col': 'River_size'}, {'features': 'fulldf', 'meta': 'wwfdf', 'target_col': 'River_size'}], 'models': [{'estimators': [{'name': 'MultinomialNB'}, {'name': 'RandomForest', 'random_state': 11235}], 'css': ['CSSLOG', 'CSS', None], 'scaler': [None], 'resampler': [None, {'name': 'RandomOverSampler', 'random_state': 11235}], 'validation': [{'name': 'StratifiedKFold', 'n_splits': 6}]}, {'estimators': [{'name': 'SVM', 'kernel': 'poly', 'degree': 1}], 'css': ['CSSLOG', 'CSS', None], 'scaler': [{'name': 'StandardScaler', 'with_mean': False}], 'resampler': [None, {'name': 'RandomOverSampler', 'random_state': 11235}], 'validation': [{'name': 'StratifiedKFold', 'n_splits': 6}]}], 'train_test_split_method': [{'name': 'StratifiedKFold', 'n_splits': 7}]}</em><a class="headerlink" href="#src.models.default_config.river_size" title="Permalink to this definition">¶</a></dt>
<dd><p>The program will loop through all dictionaries in the configuration_list and execute them</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Code Documentation</a><ul>
<li><a class="reference internal" href="#module-src.models.experiment">Experiment</a></li>
<li><a class="reference internal" href="#module-src.models.methods">Methods</a></li>
<li><a class="reference internal" href="#module-src.models.default_config">Default configuration</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="commands.html"
                        title="previous chapter">Makefile Commands</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/code.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="commands.html" title="Makefile Commands"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">peru-rivers 0.1 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright .
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.1.
    </div>
  </body>
</html>